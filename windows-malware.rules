# Sagan windows-malware.rules
# Copyright (c) 2009-2016, Quadrant Information Security <www.quadrantsec.com>
# All rights reserved.
#
# Please submit any custom rules or ideas to sagan-submit@quadrantsec.com or the sagan-sigs mailing list
#
#*************************************************************
#  Redistribution and use in source and binary forms, with or without modification, are permitted provided that the
#  following conditions are met:
#
#  * Redistributions of source code must retain the above copyright notice, this list of conditions and the following
#    disclaimer.
#  * Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the
#    following disclaimer in the documentation and/or other materials provided with the distribution.
#  * Neither the name of the nor the names of its contributors may be used to endorse or promote products derived
#    from this software without specific prior written permission.
#
#  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY EXPRESS OR IMPLIED WARRANTIES,
#  INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
#  DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
#  SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
#  SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,
#  WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE
#  USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
#
#*************************************************************
alert udp $HOME_NET any -> $EXTERNAL_NET any (msg: "[WINDOWS-MALWARE] ZeroAccess Malware Detected [5/5]"; content: "16464"; pcre: "/ 861: | 5154: | 5155: /"; threshold: type limit, track by_src, count 5, seconds 300; classtype: network-event; program: Security*; reference: url,wiki.quadrantsec.com/bin/view/Main/5001735; sid: 5001735; rev:5;)
alert udp $HOME_NET any -> $EXTERNAL_NET any (msg: "[WINDOWS-MALWARE] ZeroAccess Malware Detected [5/5]"; content: "16465"; pcre: "/ 861: | 5154: | 5155: /"; threshold: type limit, track by_src, count 5, seconds 300; classtype: network-event; program: Security*; reference: url,wiki.quadrantsec.com/bin/view/Main/5001736; sid: 5001736; rev:5;)
alert udp $HOME_NET any -> $EXTERNAL_NET any (msg: "[WINDOWS-MALWARE] ZeroAccess Malware Detected [5/5]"; content: "16470"; pcre: "/ 861: | 5154: | 5155: /"; threshold: type limit, track by_src, count 5, seconds 300; classtype: network-event; program: Security*; reference: url,wiki.quadrantsec.com/bin/view/Main/5001737; sid: 5001737; rev:5;)
alert udp $HOME_NET any -> $EXTERNAL_NET any (msg: "[WINDOWS-MALWARE] ZeroAccess Malware Detected [5/5]"; content: "16471"; pcre: "/ 861: | 5154: | 5155: /"; threshold: type limit, track by_src, count 5, seconds 300; classtype: network-event; program: Security*; reference: url,wiki.quadrantsec.com/bin/view/Main/5001738; sid: 5001738; rev:5;)
alert udp $HOME_NET any -> $EXTERNAL_NET any (msg: "[WINDOWS-MALWARE] Black POS Malware Detected [5/5]"; pcre: "/ 4657: | 567: | 4688: | 592: /"; content: "POSWDS";  classtype: trojan-activity; program: Security*; reference: url,wiki.quadrantsec.com/bin/view/Main/5001951; sid: 5001951; rev:4;)


#*************************************************************
# These rules are base upon research by Russ Anthony.  More
# information can be found in his white paper at:
# 
# https://www.sans.org/reading-room/whitepapers/logging/detecting-security-incidents-windows-workstation-event-logs-34262
#*************************************************************


alert syslog $HOME_NET any -> $EXTERNAL_NET any (msg: "[WINDOWS-MALWARE] System protection disabled"; pcre: "/ 7034: | 7035: | 7046: | 7040: | 4689: | 593: /" ; pcre: "/Defender/Anti-Virus/antivirus/i"; content: "stop control"; flowbits: isnotset,by_src,reboot.windows; program: Service_Control_Manager; classtype: trojan-activity; reference: url,wiki.quadrantsec.com/bin/view/Main/5002011; sid: 5002011; rev:6;)

alert syslog $HOME_NET any -> $EXTERNAL_NET any (msg: "[WINDOWS-MALWARE] Suspicious misspelled process"; pcre: "/ 4688: | 592: /"; pcre: "/(scvhost|svcdost|scvdost|iexplorer)\.exe/i"; classtype: trojan-activity; program: Security*; reference: url,wiki.quadrantsec.com/bin/view/Main/5001999; sid: 5001999; rev:2;)
alert syslog $HOME_NET any -> $EXTERNAL_NET any (msg: "[WINDOWS-MALWARE] Lower case drive letter used in process"; pcre: "/ 4688: | 592: /"; pcre: "/File Name: (c|d|e)\x3a/"; classtype: trojan-activity; program: Security*; reference: url,wiki.quadrantsec.com/bin/view/Main/5002000; sid: 5002000; rev:2;)
alert syslog $HOME_NET any -> $EXTERNAL_NET any (msg: "[WINDOWS-MALWARE] Incorrect path called for svchost.exe"; pcre: "/ 4688: | 592: /"; content: "\svchost.exe"; content:!"C|3a|\WINDOWS\System32\svchost.exe"; nocase; classtype: trojan-activity; program: Security*; reference: url,wiki.quadrantsec.com/bin/view/Main/5002001; sid: 5002001; rev:2;)
alert syslog $HOME_NET any -> $EXTERNAL_NET any (msg: "[WINDOWS-MALWARE] Incorrect path called for explorer.exe"; pcre: "/ 4688: | 592: /"; content: "\explorer.exe"; content:!"C|3a|\WINDOWS\explorer.exe"; nocase; classtype: trojan-activity; program: Security*; reference: url,wiki.quadrantsec.com/bin/view/Main/5002002; sid: 5002002; rev:2;)
alert syslog $HOME_NET any -> $EXTERNAL_NET any (msg: "[WINDOWS-MALWARE] Suspicious application crash"; content: " 4097|3a| "; pcre: "/Adobe|Microsoft Office|Java|wmplayer/"; classtype: trojan-activity; program: Security*; reference: url,wiki.quadrantsec.com/bin/view/Main/5002003; sid: 5002003; rev:3;)
alert syslog $HOME_NET any -> $EXTERNAL_NET any (msg: "[WINDOWS-MALWARE] Suspicious Tool Event"; pcre: "/ 4688: | 592: /"; pcre: "/win32dd.exe|win64dd.exe|cachedump|fgdump|gsecdump|lslsass|mimikatz|pwdump7|pwdumpx|pwdump|wce.exe|getlsasrvaddr|iam.exe|iam-alt|whosthere.exe|whosthere-alt|genhash/i"; program: Security*; classtype: trojan-activity; reference: url,wiki.quadrantsec.com/bin/view/Main/5002006; sid: 5002006; rev:3;)
#alert syslog $HOME_NET any -> $EXTERNAL_NET any (msg: "[WINDOWS-MALWARE] Virus Found!"; content: "virus found"; nocase; classtype: trojan-activity; reference: url,wiki.quadrantsec.com/bin/view/Main/5002007; sid: 5002007; rev:1;)

# Added by Champ Clark - 08/26/2014 

alert syslog $HOME_NET any -> $EXTERNAL_NET any (msg: "[WINDOWS-MALWARE] RASWMI Malware process detected"; pcre: "/ 4688: | 592: /"; content: "|3a|\Windows\system32\wbem\raswmi.dll"; classtype: trojan-activity; program: Security*; reference: url,wiki.quadrantsec.com/bin/view/Main/5002103; sid:5002103; rev:2;)

# Added by Champ Clark - 06/08/2016

# Security-Auditing| 4663: AUDIT_SUCCESS An attempt was made to access an object. Subject: Security ID: S-1-5-21-3033682373-1303307761-3711879957-1000 Account Name: frankw Account Domain: frankw-PC Logon ID: 0x144f4 Object: Object Server: Security Object Type: File Object Name: C:\ProgramData\Microsoft\User Account Pictures\B2DFD6E96212209F0583673878AA9EF6.locky Handle ID: 0x5d68 Process Information: Process ID: 0x6a8 Process Name: C:\Users\frankw\AppData\Local\Temp\30e22374e00af038d06063db14cb3797.exe Access Request Information: Accesses: WriteAttributes Access Mask: 0x100

alert syslog $HOME_NET any -> $EXTERNAL_NET any (msg: "[WINDOWS-MALWARE] Locky ransomware extension detected."; pcre: "/ 4663: | 567: | 5145: /"; content: ".locky "; classtype: trojan-activity; program: Security*; reference: url,wiki.quadrantsec.com/bin/view/Main/5002801; sid:5002801; rev:3;)

# Ransomware rules By Corey Fisher (cfisher@quadrantsec.com) & Bryan Manradge.
# 04/11/2016

alert syslog $EXTERNAL_NET any -> $HOME_NET any (msg:"[WINDOWS-MALWARE] Locky ransomware note detected."; pcre: "/ 4663: | 567: | 5145: /"; content: "_Locky_recover_instructions.txt"; program: Security*; classtype: trojan-activity; reference: url,http://www.bleepingcomputer.com/news/security/the-locky-ransomware-encrypts-local-files-and-unmapped-network-shares/; reference: url,wiki.quadrantsec.com/bin/view/Main/5002804; sid:5002804; rev:2;)

alert syslog $EXTERNAL_NET any -> $HOME_NET any (msg:"[WINDOWS-MALWARE] Cryptowall 4.0 ransomware note detected."; pcre: "/ 4663: | 567: | 5145: /"; pcre: "/HELP_YOUR_FILES|DECRYPT_INSTRUCTION/i"; program: Security*; classtype: trojan-activity; reference: url,http://www.bleepingcomputer.com/virus-removal/cryptowall-ransomware-information#cryptowall4; reference: url,wiki.quadrantsec.com/bin/view/Main/5002805; sid:5002805; rev:3;)

alert syslog $EXTERNAL_NET any -> $HOME_NET any (msg:"[WINDOWS-MALWARE] Cryptowall ransomware note detected."; pcre: "/ 4663: | 567: | 5145: /"; content: "HELP_DECRYPT.txt"; content: "WriteData"; program: Security*; classtype: trojan-activity; reference: url,wiki.quadrantsec.com/bin/view/Main/5002806; sid:5002806; rev:2;)

alert syslog $EXTERNAL_NET any -> $HOME_NET any (msg:"[WINDOWS-MALWARE] CryptInfinite/DecryptorMax ransomware note detected."; pcre: "/ 4663: | 567: | 5145: /"; content: "ReadDecryptFilesHere.txt"; program: Security*; classtype: trojan-activity; reference: url,http://www.bleepingcomputer.com/news/security/cryptinfinite-or-decryptormax-ransomware-decrypted/; reference: url,wiki.quadrantsec.com/bin/view/Main/5002807; sid:5002807; rev:3;)

alert syslog $EXTERNAL_NET any -> $HOME_NET any (msg:"[WINDOWS-MALWARE] TeslaCrypt ransomware note detected."; pcre: "/ 4663: | 567: | 5145: /"; pcre: "/HELP_TO_DECRYPT_YOUR_FILES.txt|Howto_Restore_FILES.txt|_how_recover_.TXT|_H_e_l_p_RECOVER_INSTRUCTIONS.txt/i"; program: Security*; classtype: trojan-activity; reference: url,www.pcrisk.com/removal-guides/8724-teslacrypt-virus; reference: url,wiki.quadrantsec.com/bin/view/Main/5002808; sid:5002808; rev:3;)

alert syslog $EXTERNAL_NET any -> $HOME_NET any (msg:"[WINDOWS-MALWARE] Teslacrypt ransomware note type 2 detected."; pcre: "/ 4663: | 567: | 5145: /"; pcre: "/\+-xxx-HELP-xxx-\+[0-9a-zA-Z]+-\+\.txt/i"; program: Security*; classtype: trojan-activity; reference: url,www.virustotal.com/en/file/161d1b77a6867603745046e81e52a186ea764ba8c723c9698da707c245505e95/analysis/1458765163/; reference: url,wiki.quadrantsec.com/bin/view/Main/5002809; sid:5002809; rev:3;)

# More Ransomware rules by Champ Clark (cclark@quadrantsec.com).  GIVE CREDIT HERE
# GIVE LINK HERE
# ADD URL TO RULES

# CryptoHasYou. - Trojan:Win32/Dynamer!ac or Rakhni

alert syslog $EXTERNAL_NET any -> $HOME_NET any (msg:"[WINDOWS-MALWARE] Rakhni or .CryptoHasYou. - Trojan:Win32/Dynamer!ac extension detected."; pcre: "/ 4663: | 567: | 5145: /"; pcre: "/.enc |.cryptohasyou /i"; program: Security*; classtype: trojan-activity; reference: url,wiki.quadrantsec.com/bin/view/Main/5002819; sid:5002819; rev:1;)
alert syslog $EXTERNAL_NET any -> $HOME_NET any (msg:"[WINDOWS-MALWARE] .CryptoHasYou. - Trojan:Win32/Dynamer!ac ransom note detected."; pcre: "/ 4663: | 567: | 5145: /"; content: "YOUR_FILES_ARE_LOCKED.txt"; program: Security*; classtype: trojan-activity; reference: url,wiki.quadrantsec.com/bin/view/Main/5002820; sid:5002820; rev:1;)

# 7ev3n - Ransom:Win32/Empercrypt.A

alert syslog $EXTERNAL_NET any -> $HOME_NET any (msg:"[WINDOWS-MALWARE] 7ev3n - Ransom:Win32/Empercrypt.A extension detected."; pcre: "/ 4663: | 567: | 5145: /"; content: ".RSA "; program: Security*; classtype: trojan-activity; reference: url,wiki.quadrantsec.com/bin/view/Main/5002821; sid:5002821; rev:1;)

# BitCryptor - Win32/Cribit or CoinVault - Ransom: MSIL/Vaultlock.A 

alert syslog $EXTERNAL_NET any -> $HOME_NET any (msg:"[WINDOWS-MALWARE] Win32/Cribit or MSIL/Vaultlock.A extension detected."; pcre: "/ 4663: | 567: | 5145: /"; content: ".clf "; nocase; program: Security*; classtype: trojan-activity; reference: url,wiki.quadrantsec.com/bin/view/Main/5002822; sid:5002822; rev:1;)

# Cerber - Win32/Cerber

alert syslog $EXTERNAL_NET any -> $HOME_NET any (msg:"[WINDOWS-MALWARE] Cerber - Win32/Cerber extension detected."; pcre: "/ 4663: | 567: | 5145: /"; content: ".cerber "; nocase; program: Security*; classtype: trojan-activity; reference: url,wiki.quadrantsec.com/bin/view/Main/5002823; sid:5002823; rev:1;)

# Chimera - Win32/Chicrypt 

alert syslog $EXTERNAL_NET any -> $HOME_NET any (msg:"[WINDOWS-MALWARE] Chimera - Win32/Chicrypt extension detected."; pcre: "/ 4663: | 567: | 5145: /"; content: ".crypt "; nocase; program: Security*; classtype: trojan-activity; reference: url,wiki.quadrantsec.com/bin/view/Main/5002824; sid:5002824; rev:1;)

# Coverton

alert syslog $EXTERNAL_NET any -> $HOME_NET any (msg:"[WINDOWS-MALWARE] Coverton extension detected."; pcre: "/ 4663: | 567: | 5145: /"; meta_content: ".%sagan% ", coverton,enigma,czvxce; meta_nocase; program: Security*; classtype: trojan-activity; reference: url,wiki.quadrantsec.com/bin/view/Main/5002825; sid:5002825; rev:1;)

# CryptInfinite

alert syslog $EXTERNAL_NET any -> $HOME_NET any (msg:"[WINDOWS-MALWARE] CryptInfinite extension detected."; pcre: "/ 4663: | 567: | 5145: /"; content: ".crinf "; nocase; program: Security*; classtype: trojan-activity; reference: url,wiki.quadrantsec.com/bin/view/Main/5002826; sid:5002826; rev:1;)

# CryptoJoker

alert syslog $EXTERNAL_NET any -> $HOME_NET any (msg:"[WINDOWS-MALWARE] CryptInfinite extension detected."; pcre: "/ 4663: | 567: | 5145: /"; content: ".crjoker "; nocase; program: Security*; classtype: trojan-activity; reference: url,wiki.quadrantsec.com/bin/view/Main/5002827; sid:5002827; rev:1;)

# CryptoTorLocker2015

alert syslog $EXTERNAL_NET any -> $HOME_NET any (msg:"[WINDOWS-MALWARE] CryptoTorLocker2015 extension detected."; pcre: "/ 4663: | 567: | 5145: /"; content: ".CryptoTorLocker2015! "; nocase; program: Security*; classtype: trojan-activity; reference: url,wiki.quadrantsec.com/bin/view/Main/5002828; sid:5002828; rev:1;)

# CryptXXX or Gomasom

alert syslog $EXTERNAL_NET any -> $HOME_NET any (msg:"[WINDOWS-MALWARE] CryptXXX or Gomasom extension detected."; pcre: "/ 4663: | 567: | 5145: /"; content: ".crypt "; nocase; program: Security*; classtype: trojan-activity; reference: url,wiki.quadrantsec.com/bin/view/Main/5002829; sid:5002829; rev:1;)

# Hi Buddy! or Rakhni

alert syslog $EXTERNAL_NET any -> $HOME_NET any (msg:"[WINDOWS-MALWARE] Hi Buddy! or Rakhni extension detected."; pcre: "/ 4663: | 567: | 5145: /"; content: ".cry "; nocase; program: Security*; classtype: trojan-activity; reference: url,wiki.quadrantsec.com/bin/view/Main/5002830; sid:5002830; rev:1;)

# iLock, iLockLight or Lortok

alert syslog $EXTERNAL_NET any -> $HOME_NET any (msg:"[WINDOWS-MALWARE] iLock, iLockLight or Lortok extension detected."; pcre: "/ 4663: | 567: | 5145: /"; content: ".crime "; nocase; program: Security*; classtype: trojan-activity; reference: url,wiki.quadrantsec.com/bin/view/Main/5002831; sid:5002831; rev:1;)

# Jigsaw - Ransom:MSIL/JigsawLocker.A

alert syslog $EXTERNAL_NET any -> $HOME_NET any (msg:"[WINDOWS-MALWARE] Jigsaw - MSIL/JigsawLocker.A"; pcre: "/ 4663: | 567: | 5145: /"; meta_content: ".%sagan% ", btc,kkk,fun,gws; meta_nocase; program: Security*; classtype: trojan-activity; reference: url,wiki.quadrantsec.com/bin/view/Main/5002832; sid:5002832; rev:1;)

# Job Crypter, KimcilWare or Rakhni

alert syslog $EXTERNAL_NET any -> $HOME_NET any (msg:"[WINDOWS-MALWARE] Job Crypter, KimcilWare or "Rakhni extension detected."; pcre: "/ 4663: | 567: | 5145: /"; content: ".locked "; nocase; program: Security*; classtype: trojan-activity; reference: url,wiki.quadrantsec.com/bin/view/Main/5002833; sid:5002833; rev:1;)

# KeyBTC - Ransom: Win32/Isda - Ransom: BAT/Xibow

alert syslog $EXTERNAL_NET any -> $HOME_NET any (msg:"[WINDOWS-MALWARE] KeyBTC - Win32/Isda - BAT/Xibow extension detected."; pcre: "/ 4663: | 567: | 5145: /"; content: ".keybtc@inbox_com "; nocase; program: Security*; classtype: trojan-activity; reference: url,wiki.quadrantsec.com/bin/view/Main/5002834; sid:5002834; rev:1;)

# KimcilWare

alert syslog $EXTERNAL_NET any -> $HOME_NET any (msg:"[WINDOWS-MALWARE] KimcilWare extension detected."; pcre: "/ 4663: | 567: | 5145: /"; content: ".kimcilware "; nocase; program: Security*; classtype: trojan-activity; reference: url,wiki.quadrantsec.com/bin/view/Main/5002835; sid:5002835; rev:1;)

# LeChiffre

alert syslog $EXTERNAL_NET any -> $HOME_NET any (msg:"[WINDOWS-MALWARE] LeChiffre extension detected."; pcre: "/ 4663: | 567: | 5145: /"; content: ".lechiffre "; nocase; program: Security*; classtype: trojan-activity; reference: url,wiki.quadrantsec.com/bin/view/Main/5002836; sid:5002836; rev:1;)

# LowLevel04

alert syslog $EXTERNAL_NET any -> $HOME_NET any (msg:"[WINDOWS-MALWARE] LowLevel04 extension detected."; pcre: "/ 4663: | 567: | 5145: /"; content: ".oor."; nocase; program: Security*; classtype: trojan-activity; reference: url,wiki.quadrantsec.com/bin/view/Main/5002847; sid:5002847; rev:1;)

# Magic

alert syslog $EXTERNAL_NET any -> $HOME_NET any (msg:"[WINDOWS-MALWARE] Magic extension detected."; pcre: "/ 4663: | 567: | 5145: /"; content: ".magic "; nocase; program: Security*; classtype: trojan-activity; reference: url,wiki.quadrantsec.com/bin/view/Main/5002837; sid:5002837; rev:1;)

# MireWare

alert syslog $EXTERNAL_NET any -> $HOME_NET any (msg:"[WINDOWS-MALWARE] MireWare extension detected."; pcre: "/ 4663: | 567: | 5145: /"; content: ".fucked "; nocase; program: Security*; classtype: trojan-activity; reference: url,wiki.quadrantsec.com/bin/view/Main/5002838; sid:5002838; rev:1;)

# Nemucod

alert syslog $EXTERNAL_NET any -> $HOME_NET any (msg:"[WINDOWS-MALWARE] Nemucod extension detected."; pcre: "/ 4663: | 567: | 5145: /"; content: ".fucked "; nocase; program: Security*; classtype: trojan-activity; reference: url,wiki.quadrantsec.com/bin/view/Main/5002839; sid:5002839; rev:1;)

# Offline ransomware

alert syslog $EXTERNAL_NET any -> $HOME_NET any (msg:"[WINDOWS-MALWARE] Offline ransomware extension detected."; pcre: "/ 4663: | 567: | 5145: /"; content: ".cbf "; nocase; program: Security*; classtype: trojan-activity; reference: url,wiki.quadrantsec.com/bin/view/Main/5002840; sid:5002840; rev:1;)

# OMG! Ransomware

alert syslog $EXTERNAL_NET any -> $HOME_NET any (msg:"[WINDOWS-MALWARE] OMG! ransomware extension detected."; pcre: "/ 4663: | 567: | 5145: /"; content: ".LOL! "; nocase; program: Security*; classtype: trojan-activity; reference: url,wiki.quadrantsec.com/bin/view/Main/5002841; sid:5002841; rev:1;)

# Radamant 

alert syslog $EXTERNAL_NET any -> $HOME_NET any (msg:"[WINDOWS-MALWARE] Radamant ransomware extension detected."; pcre: "/ 4663: | 567: | 5145: /"; content: ".RADAMANT "; nocase; program: Security*; classtype: trojan-activity; reference: url,wiki.quadrantsec.com/bin/view/Main/5002842; sid:5002842; rev:1;)

# Rakhni

alert syslog $EXTERNAL_NET any -> $HOME_NET any (msg:"[WINDOWS-MALWARE] Coverton extension detected."; pcre: "/ 4663: | 567: | 5145: /"; meta_content: ".%sagan% ",kraken,darkness,nochance,oshit,oplata@qq_com,relock@qq_com,crypto,helpdecrypt@ukr.net,pizda@qq_com,dyatel@qq_com,_ryp,nalog@qq_com,chifrator@qq_com,gruzin@qq_com,troyancoder@qq_com,encrypted,AES256,hb15; meta_nocase; program: Security*; classtype: trojan-activity; reference: url,wiki.quadrantsec.com/bin/view/Main/5002843; sid:5002843; rev:1;)

# RemindMe

alert syslog $EXTERNAL_NET any -> $HOME_NET any (msg:"[WINDOWS-MALWARE] RemindMe ransomware extension detected."; pcre: "/ 4663: | 567: | 5145: /"; content: ".remindme "; nocase; program: Security*; classtype: trojan-activity; reference: url,wiki.quadrantsec.com/bin/view/Main/5002844; sid:5002844; rev:1;)

# Rokku

alert syslog $EXTERNAL_NET any -> $HOME_NET any (msg:"[WINDOWS-MALWARE] Rokku ransomware extension detected."; pcre: "/ 4663: | 567: | 5145: /"; content: ".rokku "; nocase; program: Security*; classtype: trojan-activity; reference: url,wiki.quadrantsec.com/bin/view/Main/5002845; sid:5002845; rev:1;)

# Samas-Samsam

alert syslog $EXTERNAL_NET any -> $HOME_NET any (msg:"[WINDOWS-MALWARE] Samas-Samsam extension detected."; pcre: "/ 4663: | 567: | 5145: /"; meta_content: ".%sagan% ",encryptedAES,encryptedRSA,encedRSA,justbtcwillhelpyou,btcbtcbtc; meta_nocase; program: Security*; classtype: trojan-activity; reference: url,wiki.quadrantsec.com/bin/view/Main/5002846; sid:5002846; rev:1;)


